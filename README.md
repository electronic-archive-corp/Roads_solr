Roads_solr
============

Alternative way to search

search api and possible web wrapper for some kind of search (Аналогично Sphinx api)

Использовать solr-client: https://www.npmjs.org/package/solr-client

## Отличие терминологии от Sphinx:
  В Solr строится **один index.** 
  Для этих целей используется filter: в запросе (&fq=index:people&q=)
  
  **Поэтому идентификатор должен быть уникальным** для всех записей!!!

### add - добавление

**Входные параметры:**

{ "index":"people", "items":[ {"id":123, "surname":"Иванов", "name":"Иван"}, .... ] }

var doc = {
       index: "people",
       id : 123,
       surname : "Иванов",
       name: "Иван"
   }
   docs.push(doc);
   
 - index* - имя используемого индекса (поле для фильтра)
 - items* - массив новых записей
      
**Выходные параметры:**

{ "result":"OK" }
 - успешность выполнения

### find - поиск записей
**Входные параметры:**

{ "index":"people", "start":"0", "count":"50", "fields":{ "rank":"сержант", "birth_date":"1922" } }

Запрос к Solr:
   .matchFilter(("index","people").q({"rank":"сержант", "birth_date":"1922"}).start(0).rows(50)
   
 - index* - имя используемого индекса (фильтр)
 - start  Порядковый номер первой записи
 - count  количество записей
 - fields значения поисковых полей
      
**Выходные параметры:**

{ "result":"OK",  "numFounds":20, "start":0, "ids":[123,124,2345] }
 - успешность выполнения
 - число найденных документов
 - номер первой найденной записи (смещение)
 - массив найденных идентификаторов
  

### delete - удаление

**Входные параметры:**

{  "ids":[123,124,2345] }

 - ids* - массив идентификаторов

  index не используется, т.к. ид. уникальный. Возможно удаление по условию.
  
**Выходные параметры:**

{ "result":"OK" }

 - Удачность операции


### change_index - изменение параметров индекса
  
   Для Solr делать не нужно, т.к. при добавлении-удалении записей перестроение происходит автоматом


### commit_index - commit данных
  client.commit
**Входные параметры:**

**Выходные параметры:**

После запроса происходит перестроение индекса


### rollback_index - rollback данных
  client.rollback
**Входные параметры:**

**Выходные параметры:**

После запроса происходит откат изменений. Индекс не меняется.



#### * - обязательные параметры

